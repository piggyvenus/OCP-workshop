## Split Traffic 

**Load Balancing for A/B Testing**

You can run two versions of an application, and, entirely within OpenShift Container Platform, control the percentage of traffic to and from each application for A/B testing. A/B testing is a method of comparing two versions of an application against each other to determine which one performs better.

Previously, A/B testing only worked by adding or removing more pods of every kind (A or B). However, this was not a scalable solution because for lower B percentages, you would create a large number of pods. Starting in 3.3, the HAProxy router now supports splitting the traffic coming to a route across multiple back end services via weighting.


**Lab #5: Split Traffic**

1. From your browser, go to https://ocp-master.ccatg.cisco.com:8443
2. Select cisco_ldap_provider under Log in with...
3. Enter your LDAP id and password
4. Click login if you are not login
5. Click on your project name `username-proj` 
6. Click Add project
7. From the Browse Catalog, type `php`
8. Select PHP 5.6
9. Add phpapp-one as Name and https://bitbucket-eng-chn-sjc1.cisco.com/bitbucket/scm/cctgdev/ocpworkshop-php.git as git repo URL.
10. Click `Continue to Review` and it will bring you back to Overview page
11. Click `View Log` 
12. To test split traffic, we need to deploy one more php application
13. Click `Overview` on left nav 
14. 6. Click Add project
15. From the Browse Catalog, type `php`
16. Select PHP 5.6
17. Add phpapp-two as Name and https://github.com/piggyvenus/simplephp.git as git repo URL.
18. Click `Continue to Review` and it will bring you back to Overview page
19. Click `View Log` 
20. Check the routes for both PHP apps are working
21. Go `Application` on left nav → Select Route → phpapp-one 
22. Click `Action` on top right corner → select Edit
23. Click `split traffic`
24. Select the 1st service as phpapp-one with 50 weight and phpapp-two as 50 weight
25. Click `Save`
26. Click `Overview`
27. Click the phpapp-one route from current browser
28. Open a different browser, copy the URL for the phpapp-one on the 2nd browser.
29. It should route to the phpapp-two app.
30. Congrats! you have completed Lab #5 on OpenShift.




